

# Android DeepLearning

- Userìª½ì—ì„œ ê¸°ê³„í•™ìŠµ
- Serverìª½ì—ì„œ ê¸°ê³„í•™ìŠµ



## 1.Userìª½ì—ì„œ ê¸°ê³„í•™ìŠµ

ì•ˆë“œë¡œì´ë“œ(iOS)ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ê¸°ê³„ í•™ìŠµì„ ì´ìš©

- ê¸°ê³„í•™ìŠµ ëª¨ë¸ì„ ì„œë²„ì— ë‘ê³  ìŠ¤ë§ˆíŠ¸ í°ì˜ ì•±ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ëŠ” ì…ì¶œë ¥ì˜ ì—­í• ë§Œ ìˆ˜í–‰

- ìŠ¤ë§ˆíŠ¸ í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ë°ì´í„° ì…ì¶œë ¥í•˜ëŠ” ë°©ë²•ë§Œ ë°°ìš°ë©´ ë©ë‹ˆë‹¤.



### ì¥/ë‹¨ì 

- ë‹¨ì 
  - í•­ìƒ ì˜¨ë¼ì¸ ìƒíƒœì—¬ì•¼ í•œë‹¤ëŠ” ê²ƒ

- ì¥ì 
  - ëª¨ë¸ì„ í•œë²ˆë§Œ ìƒì„±í•˜ë©´ ë©ë‹ˆë‹¤



## 2.Serverìª½ì—ì„œ ê¸°ê³„í•™ìŠµ

ìŠ¤ë§ˆíŠ¸í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì— ê¸°ê³„ í•™ìŠµ ëª¨ë¸ì„ ì €ì¥í•´ì„œ ìŠ¤ë§ˆíŠ¸ í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì—¬ ì¶œë ¥í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•

- ëª¨ë¸ ìì²´ëŠ” ì¼ë°˜ì ìœ¼ë¡œ PCì—ì„œ ë§Œë“¤ê³  ì´ë¥¼ ìŠ¤ë§ˆíŠ¸ í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë³€í™˜í•´ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
- ì¼€ë¼ìŠ¤ì˜ ê²½ìš°ëŠ” ì•ˆë“œë¡œì´ë“œì—ì„œ ë™ì‘í•˜ëŠ” TensorFlow liteê°€ ìˆìŠµë‹ˆë‹¤
- ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ë™ì‘í•˜ëŠ” TensorFlow.jsì˜ ëª¨ë¸ë¡œ ë³€í™˜í•´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤



### ì¥/ë‹¨ì 

- ë‹¨ì  
  - ëª¨ë¸ì„ ìˆ˜ì •í•˜ë©´ ë‹¤ì‹œ ë°°í¬í•´ì•¼ í•©ë‹ˆë‹¤. PCì—ì„œ ìˆ˜í–‰í–ˆë˜ ì „ì²˜ë¦¬ë¥¼ ìŠ¤ë§ˆíŠ¸í°ì—ì„œ ë‹¤ì‹œ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ”ë° ì´ ë•Œ ì–¸ì–´ë‚˜ í”„ë ˆì„ì›Œí¬ê°€ ì§€ì›ì´ ì•ˆë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - OpenCVê°™ì€ ê²½ìš°ëŠ” ì–¸ì–´ë³„ë¡œ ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¡´ì¬í•˜ëŠ”ë° ëª¨ë“  ë””ë°”ì´ìŠ¤ì—ì„œ ì§€ì›í•˜ëŠ” ì–¸ì–´ëŠ” C++ì…ë‹ˆë‹¤.
  - ì–´ë–¤ ì–¸ì–´ë¡œ êµ¬í˜„í•˜ê²Œ ë ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì‚¬ì‹¤ ì–´ë–¤ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ëŠëƒ ë³´ë‹¤ ì•Œê³ ë¦¬ì¦˜ì´ ë” ì¤‘ìš”í•©ë‹ˆë‹¤.
- ì¥ì 
  - ì˜¨ë¼ì¸ ìƒíƒœê°€ ì•„ë‹ˆì—¬ë„ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.



# í…ì„œí”Œë¡œ ë¼ì´íŠ¸ ëª¨ë¸ ê°œë°œ WorkFlow

`1.ëª¨ë¸ ìƒì„± ğŸ‘‰ 2.ëª¨ë¸ ë³€í™˜ ğŸ‘‰ 3.ê¸°ê¸° ë°°í¬ ğŸ‘‰ 4.ëª¨ë¸ ìµœì í™”`

4.ëª¨ë¸ ìµœì í™”ë¥¼ í•œ í›„ ë‹¤ì‹œ ëª¨ë¸ ë³€í™˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°ë„ ìˆìŒ



## 1.ëª¨ë¸ ì„ íƒ ë°©ë²•

- ì§ì ‘ ìƒì„±í•  ìˆ˜ ìˆê³  ì´ë¯¸ ê°œë°œëœ ëª¨ë¸ì„ ì´ìš©í•  ìˆ˜ ìˆìŒ

ì„¤ê³„ ğŸ‘‰ í•™ìŠµ ğŸ‘‰ ë³€í™˜

- ëª¨ë¸ ì§ì ‘ ê°œë°œ : ì„¤ê³„ ->í•™ìŠµ -> ë³€í™˜
- ì‚¬ì „ í•™ìŠµ ëª¨ë¸ ì´ìš©
  - í…ì„œí”Œë¡œ ëª¨ë¸  : í•™ìŠµ -> ë³€í™˜ì˜ ê³¼ì •ì´ë‚˜ ë³€í™˜ë§Œìœ¼ë¡œ ì‚¬ìš©
  - í…ì„œí”Œë¡œ ë¼ì´íŠ¸ ëª¨ë¸ :ì•„ë¬´ëŸ° ì‘ì—…ë„ í•  í•„ìš”ê°€ ì—†ìŒ
- ì „ì´ í•™ìŠµ : í•™ìŠµ -> ë³€í™˜

## 2.ëª¨ë¸ ì§ì ‘ ìƒì„±

### 1) MNISTë°ì´í„° ì…‹ì„ ì´ìš©í•˜ì—¬ ì†ê¸€ì”¨ ë¶„ë¥˜ ëª¨ë¸ì„ ì§ì ‘ ë§Œë“¤ê¸°

- ëª¨ë¸ì„ ì§ì ‘ ë§Œë“¤ ë•ŒëŠ” ì €ìˆ˜ì¤€ API(í…ì„œ í”Œë¡œ, Thearno, CNTK ë“±)ë‹ˆ ê³ ìˆ˜ì¤€API(Keras, Pytorch)ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ ì„ íƒ

#### ë°ì´í„° ì¤€ë¹„

í…ì„œí”Œë¡œ ë°ì´í„° ì…‹ì„ ì´ìš©

ì´ ì´ë¯¸ì§€ëŠ” 28* 28 í¬ê¸°ì˜ ì´ë¯¸ì§€ë¡œ 7ë§Œê°œì˜ ë°ì´í„°ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.

X_trainì€ 6ë§Œê°œ X_testë¡œ 1ë§Œê°œë¡œ êµ¬ë³¸

y_trainì€ 



```python
## ë°ì´í„° ì¤€ë¹„
import tensorflow as tf
mnist = tf.keras.datasets.mnist
(X_train, y_train), (X_test, y_test) = mnist.load_data()
```



#### ë°ì´í„° ì •ê·œí™”

- ë°ì´í„°ì˜ ë²”ìœ„ë¥¼ ì¼ì •í•˜ê²Œ ë§Œë“œëŠ” ê²ƒ

- ì •ê·œí™”ë¥¼ í•˜ì§€ ì•Šì•˜ì„ ë•Œë³´ë‹¤ ì •ê·œí™”ë¥¼ í–ˆì„ ë–„ ì •í™•ë„ê°€ ë†’ê²Œ ë‚˜ì˜µë‹ˆë‹¤.

- ì›ë³¸ ë°ì´í„°ì˜ ê°’ ë²”ìœ„ëŠ” 0~255ì¸ë° 0.0ì—ì„œ 1.0ì‚¬ì´ë¡œ ì •ê·œí™” í•©ë‹ˆë‹¤.



#### ëª¨ë¸ ìƒì„±

```python
# ë”¥ëŸ¬ë‹, ë‹¤ì¤‘ í¼ì…‰íŠ¸ë¡ 
mlp_model = tf.keras.models.Sequential([
    tf.keras.layers.Flatten(input_shape = (28, 28)),
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dense(10, activation='softmax')
])
```



#### ëª¨ë¸ ì»´íŒŒì¼

##### ì†ì‹¤ í•¨ìˆ˜ loss

- íšŒê·€(ê°’)
  - MSEëŒ€ì‹ ì— MAEë‚˜ RMSE ë“±ì„ ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤.

- ë¶„ë¥˜(í™•ë¥ )
  - ì´ì§„ ë¶„ë¥˜ì˜ ê²½ìš° : binary_crossentropy
  - ë‹¤ì¤‘ ë¶„ë¥˜ì˜ ê²½ìš° : 
    - sparse_categorical_crossentropy(ì›í•«ì¸ì½”ë”©ì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°)
    - categorical_crossentropy(ì›í•«ì¸ì½”ë”©ì´ ì ìš©ë˜ëŠ” ê²½ìš°)



```python
# ëª¨ë¸ ì»´íŒŒì¼
mlp_model.compile(optimizer='adam',
                loss='sparse_categorical_crossentropy',
                metrics=['accuracy'])

y_train = tf.keras.utils.to_categorical(self.y_train)
y_test = tf.keras.utils.to_categorical(self.y_test)
mlp_model.compile(optimizer='adam',
                loss='categorical_crossentropy',
                metrics=['accuracy'])
```



#### ëª¨ë¸ êµ¬ì¡° í™•ì¸

```python
print(mlp_model.summary())
```

```
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            (None, 784)               0         
_________________________________________________________________
dense (Dense)                (None, 128)               100480    
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1290      
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None

Process finished with exit code 0

```

#### ëª¨ë¸ í•™ìŠµ

```python
mlp_model.fit(self.X_train, y_train, epochs=5)
```

```
Epoch 1/5
1875/1875 [==============================] - 4s 1ms/step - loss: 0.2587 - accuracy: 0.9257
Epoch 2/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1138 - accuracy: 0.9667
Epoch 3/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0797 - accuracy: 0.9759
Epoch 4/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0589 - accuracy: 0.9821
Epoch 5/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0452 - accuracy: 0.9861
```



#### ëª¨ë¸ í‰ê°€

- `verbose` 1 : ê³¼ì •í‘œì‹œ, 2 : ì†ì‹¤í‘œì‹œ

```python
mlp_model.evaluate(self.X_test, y_test, verbose=1)
```

313/313 [==============================] - 0s 801us/step - loss: 0.0802 - accuracy: 0.9759

- 2: ì†ì‹¤í‘œì‹œ

```python
mlp_model.evaluate(self.X_test, y_test, verbose=2)
```

313/313 - 0s - loss: 0.0855 - accuracy: 0.9741



## 3.ì‚¬ì „ í•™ìŠµ ëª¨ë¸ ì´ìš©

- í¬íŠ¸í´ë¦¬ì˜¤ í•  ë•Œ ì‚¬ì „ í•™ìŠµì¸ì§€ ì „ì´ í•™ìŠµì„ ì´ìš©í•˜ëŠ” ê²ƒì„ êµ¬ë³„í•  ì¤„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤

ì´ë¯¸ í›ˆë ¨ëœ ëª¨ë¸ë¡œ í•™ìŠµ ì ˆì°¨ì—†ì´ ë°”ë¡œ ì´ ëª¨ë¸ì„ ì´ìš©í•´ì„œ ì¶”ë¡ í•  ìˆ˜ ìˆìŒ

í…ì„œí”Œë¡œ ëª¨ë¸ë¡œ ì œê³µí•˜ê¸°ë„ í•©ë‹ˆë‹¤.

kerasëª¨ë“ˆì—ì„œ ì œê³µí•˜ê¸°ë„ í•˜ê³  í…ì„œ í”Œë¡œ í—ˆë¸Œì—ê²Œ ì œê³µí•˜ê¸°ë„ í•©ë‹ˆë‹¤.

tensorFlow liteëª¨ë¸ë¡œ ì œê³µí•˜ëŠ” ì¢…ë¥˜ëŠ” ì´ë¯¸ì§€ ë¶„ë¥˜, ê°ì²´ íƒì§€, ì´ë¯¸ì§€ ë¶„í• , ìì„¸ ì¶”ì •, ìŠ¤íƒ€ì¼ ë³€í™˜. í…ìŠ¤íŠ¸ ë³€í™˜, ì§ˆì˜ ì‘ë‹µ, ìŠ¤ë§ˆíŠ¸ ë‹µì¥(ì±—ë³¸) ë“±ì´ ìˆìŠµë‹ˆë‹¤. 



### 3) ì „ì´ í•™ìŠµ

ì´ë¯¸ í•™ìŠµì´ ì™„ë£Œëœ ëª¨ë¸ì„ ë‹¤ë¥¸ ë¬¸ì œì— ë‹¤ì‹œ í•™ìŠµì‹œí‚¤ëŠ” ë°©ì‹



### 4) ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ì´ë‚˜ ë°ì´í„°ì…‹ ì €ì¥ì†Œ

ì „ì´ í•™ìŠµì€ í•™ìŠµëœ ëª¨ë¸ì„ ì›í•˜ëŠ” ë°ì´í„°ë¡œ ë‹¤ì‹œ í•™ìŠµì‹œí‚¤ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

#### ëª¨ë¸

TensorFlow Hub: [https://tfhub.dev](https://tfhub.dev)

ê¹ƒí—ˆë¸Œ í…ì„œ í”Œë¡œ ê°€ë“  : [https:// github/com/tensorflow/models/tree/official](https:// github/com/tensorflow/models/tree/official)

Papers with Code :[https://paperswithcode.sofa](https://paperswithcode.sofa)



####  ë°ì´í„° ì…‹

- í…ì„œí”Œë¡œ ë°ì´í„° ì…‹

- êµ¬ê¸€ ë¦¬ì„œì¹˜ ë°ì´í„° ì…‹

- êµ¬ê¸€ í´ë¼ìš°ë“œ ë°ì´í„° ì…‹

- ìºê¸€ ë°ì´í„° ì…‹



### TensorFlow ì „ì´ëª¨ë¸

1. [https://tfhub.dev](https://tfhub.dev)

2. "mobilenet_v2_100_224" ê²€ìƒ‰(100_224 ëŠ” ë„ˆë¹„ì™€ ë†’ì´ë¼ëŠ” ëœ»)

   [https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/5](https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/5)

2. 

2. ëª¨ë¸ ì´ë¦„ ë’¤ì— feature_vectorê°€ ë¶™ëŠ” ê²½ìš°ëŠ” ì „ì´ í•™ìŠµì´ ê°€ëŠ¥í•˜ë„ë¡ ë§ˆì§€ë§‰ ë ˆì´ì–´ë¥¼ ì œê±°í•œ ëª¨ë°ë§ê³   classificationì´ ë¶™ì€ ê²½ìš°ì—” ë°”ë¡œ ë¶„ë¥˜ê°€ ê°€ëŠ¥í•œ ì „ì²´ ëª¨ë¸ì…ë‹ˆë‹¤.



ì•„ëŠ” ëª¨ë¸ì´ ìˆìœ¼ë©´ ê²€ìƒ‰ì„ í•˜ê³  ì—†ìœ¼ë©´ 



tf lite ëŠ” ì•ˆë“œë¡œì´ë“œì—ì„œ ë°”ë¡œ ê°€ì ¸ë‹¤ê°€ ì“¸ìˆ˜ìˆìŠµë‹ˆë‹¤. 

copy urlê³¼ downloadê°€ ê°€ëŠ¥í•œë° urlì´ ì¡´ì¬í•˜ë©´ Copy URLì„ ì„ íƒí•´ì„œ URL ì„ ë³µì‚¬í•©ë‹ˆë‹¤.

ë³´í†µ ëª¨ë¸ ì´ë¦„ì€ ì•„ë˜ì™€ ê°™ì´ ìƒì„±í•©ë‹ˆë‹¤.

```python
ëª¨ë¸ ì´ë¦„ = tf.keras.Sequential([
	tensorflow_hub.KerasLayer(url, input_shape=(ì…ë ¥ êµ¬ì¡°), trainable=False),
	tf.keras.layers.Dense(ì¶œë ¥ì˜ ê°œìˆ˜)
])	
```

í…ì„œí”Œë¡œ í—ˆë¸Œì—ì„œ ê°€ì ¸ì˜¨ ì „ì´ í•™ìŠµ ëª¨ë¸ì„ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.





## 2.ëª¨ë¸ ë³€í™˜

- tensorflow liteëª¨ë¸(tflite í™•ì¥ìê°€ ì¼ë°˜ì )ë¡œ ë³€í™˜

- tensorflow.lite.TFLiteCoverter.from_keras_model(ëª¨ë¸ì´ë¦„) ì„ í˜¸ì¶œí•´ì„œ ë³€í™˜ê¸°ë¥¼ ë§Œë“¤ê³  convert í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ëª¨ë¸ì´ ë³€í™˜ì´ ë©ë‹ˆë‹¤.
- ë³€í™˜ëœ ëª¨ë¸ì„ íŒŒì¼ì— ê¸°ë¡í•˜ë©´ ë©ë‹ˆë‹¤.
- í™•ì¥ìëŠ” íŠ¹ë³„í•œ ê²½ìš°ê°€ ì•„ë‹ˆë©´ tfliteë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.



### ì´ì „ì— ìƒì„±í•œ ëª¨ë¸ì„ TensorFlow Liteëª¨ë¸ë¡œ ë³€í™˜

```python
# TensorFlowLite ëª¨ë¸ë¡œ ë³€í™˜
def convertTensorFlowLite(self, model):
    converter = tf.lite.TFLiteConverter.from_keras_model(model)
    tflite_model = converter.convert()

    with open('./keras_model.tflite', 'wb') as f:
    f.write(tflite_model)
```

```
INFO:tensorflow:Assets written to: /tmp/tmplife93gn/assets
/usr/local/lib/python3.7/dist-packages/keras/utils/generic_utils.py:497: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  category=CustomMaskWarning)
```



## 3.ê¸°ê¸° ë°°í¬

- ì•ˆë“œë¡œì´ë“œ í”„ë¡œì íŠ¸ assets ë””ë ‰í† ë¦¬ì— ë³€í™˜ëœ ëª¨ë¸ì„ ë³µì‚¬
- ì²˜ìŒì— ë³µì‚¬í•˜ì§€ ì•Šê³  ì•±ì„ ì‹¤í–‰í•  ë•Œ ì„œë²„ì—ì„œ ë‹¤ìš´ë¡œë“œ ë°›ì•„ë„ ë©ë‹ˆë‹¤.



### ğŸ“‚assets ë””ë ‰í† ë¦¬ì™€ ğŸ“‚res ë””ë ‰í† ë¦¬ì˜ ì°¨ì´

- assets ë””ë ‰í† ë¦¬
  - ë°ì´í„°ê°€ í•„ìš”í•  ë•Œ ì½ì–´ì˜µë‹ˆë‹¤.
  - í¬ê¸°ê°€ í° ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
- res ë””ë ‰í† ë¦¬
  - ì•±ì´ ì‹¤í–‰ë  ë•Œ ì „ë¶€ ì½ì–´ì„œ ë©”ëª¨ë¦¬ì— ë¡œë“œí•©ë‹ˆë‹¤.
  - í¬ê¸°ê°€ ì‘ì€ ë°ì´í„°ë¥¼ ì €ì¥í•©ë‹ˆë‹¤.



#### assets ë””ë ‰í† ë¦¬ë§Œë“¤ê¸°

í”„ë¡œì íŠ¸ ì˜¤ë¥¸ìª½ í´ë¦­- [New]- [Folder]- [Assets Folder]ì„ í´ë¦­í•˜ì—¬ assets ë””ë ‰í† ë¦¬ë¥¼ ì˜¬ë°”ë¥¸ ê²½ë¡œì— ìƒì„±í•©ë‹ˆë‹¤.  ë””ë ‰í† ë¦¬ ê²½ë¡œë¥¼ í‹€ë¦¬ì§€ ì•Šì•„ ì§ì ‘ í´ë”ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒë³´ë‹¤ ë” ì•ˆì „í•©ë‹ˆë‹¤.



#### TensorFlow Liteë¥¼ assetsì— ìœ„ì¹˜ì‹œí‚¤ê¸°

ìœ„ì—ì„œ ë³€í™˜ì‹œí‚¨ TensorFlow Lite ëª¨ë¸ì„ assets ë””ë ‰í† ë¦¬ì— ìœ„ì¹˜ì‹œí‚¤ë©´ ê¸°ê¸° ë°°í¬ ì¤€ë¹„ê°€ ëœ ê²ƒì…ë‹ˆë‹¤.







## 4.ëª¨ë¸ ìµœì í™”

- ëª¨ë¸ì„ ë§Œë“¤ ë•Œë„ ìˆ˜í–‰í•˜ì§€ë§Œ ì•ˆë“œë¡œì´ë“œ ê¸°ê¸°ì—ì„œ ìµœì í™” ë˜ì—ˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸í•˜ê¸°ë„ í•©ë‹ˆë‹¤.
- ëŒ€ë¶€ë¶„ PCì—ì„œ ëª¨ë¸ ìƒì„±ì„ í•˜ëŠ”ë° ì•ˆë“œë¡œì´ë“œì—ì„œ ì„±ëŠ¥ì´ ë” ë–¨ì–´ì§ˆ ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.



## 5.Android Studioì™€ Github ì—°ë™

ìµœê·¼ì˜ IDEëŠ” IDEì— Gitì„ ì—°ë™ì‹œí‚¤ëŠ” ë°©ì‹ì„ ë§ì´ ì·¨í•©ë‹ˆë‹¤.

#### 

### 1) Android Studioì—ì„œ Githubì—°ë™í•  ê²½ìš°

1. [File]-[Settings]ë©”ë‰´ë¥¼ ì‹¤í–‰

2. Version Control íƒ­ ì´ë™-[GitHub]-Add Account
3. Githubì˜ IDì™€ Password ì…ë ¥
4. + ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ  login with token - generate - 



### 2) Githubì—ì„œ Tokenë³µì‚¬í•˜ëŠ” ê²½ìš°

1. github ì›¹ ì‚¬ì´íŠ¸ ì ‘ì†
2. [Settings]-[Developer settings] ì´ë™

3. Personal access tokensì´ë™
4. genetate new token í´ë¦­í•˜ê³  tokenì˜ ì´ë¦„ì„ ì…ë ¥í•˜ê³  ê¶Œí•œì„ ì„¤ì •í•˜ê³  ì €ì¥
5. ìƒì„±ëœ Tokenì˜ urlì„ ë³µì‚¬ 
6. Android Studioë¡œ ì´ë™í•˜ì—¬ [File]-[Settings]ë©”ë‰´ë¥¼ ì‹¤í–‰
7. Version Control íƒ­ ì´ë™-[GitHub]-`+`í´ë¦­-[Login with token]
8. ë³µì‚¬í–ˆë˜ Token url ë¶™ì—¬ë„£ê¸°

#### 

### 3) í”„ë¡œì íŠ¸ ì—…ë¡œë“œ

1. [VCS]-[share project github]-í”„ë¡œì íŠ¸ ì„ íƒ-Add



### 4) í”„ë¡œì íŠ¸ ê°€ì ¸ì˜¤ê¸°

[File]-New -[from Version Control]ì„ ì„ íƒí•˜ê³  URLì„ ì…ë ¥

- URL : [https://github.com/itggangpae/DigitClassifier](https://github.com/itggangpae/DigitClassifier)



# ğŸ”¢ìˆ«ì ë¶„ë¥˜ Android App

- View ìœ„ì— ìˆ«ì ê·¸ë¦¬ê³  ìˆ«ì ë¶„ë¥˜í•˜ëŠ” Android App ë§Œë“¤ê¸°

## 1.Android í”„ë¡œì íŠ¸ ìƒì„±

ViewDrawingDigitClassifier



## 2.ì•ˆë“œë¡œì´ë“œ í™”ë©´ì— ê·¸ë¦¼ì„ ê·¸ë¦´ ìˆ˜ ìˆëŠ” Viewì‚¬ìš©ì„ ìœ„í•œ ì„¤ì •

- ì´ ì„¤ì •ì„ í•˜ì§€ ì•Šê³  ì§ì ‘ Drawingì´ ê°€ëŠ¥í•˜ì§€ë§Œ ì½”ë“œê°€ ì–´ë ¤ì›Œì§€ë¯€ë¡œ ì´ë¯¸ ë§Œë“¤ì–´ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•©ë‹ˆë‹¤.
- ì˜ˆì „ì— ë§Œë“¤ì–´ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” settings.gradleê³¼ moduleìˆ˜ì¤€ì˜ build.gradleì„ ì´ìš©í•˜ê³  ìµœê·¼ì— ë§Œë“¤ì–´ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” í”„ë¡œì íŠ¸ ìˆ˜ì¤€ì˜ build.gradleê³¼ module ìˆ˜ì¤€ì˜ build.gradle ì„ ì´ìš©í•©ë‹ˆë‹¤.
- ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ë‹¤ìš´ë¡œë“œê°€ ë©ë‹ˆë‹¤.
- settings.gradle íŒŒì¼ì˜ allprojects ì— ì¶”ê°€í•©ë‹ˆë‹¤. ì €ì¥ì†Œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.



### **repository

- ì–¸ì–´ë‚˜ í”„ë ˆì„ì›Œí¬ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” ì¥ì†Œ
- central repositoryëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ëª¨ì•„ì ¸ ìˆëŠ” ì¥ì†Œì¸ë° ê°€ì¥ ë§ì€ ê°œë°œìë“¤ì´ ì´ìš©í•˜ëŠ” ì¥ì†Œì…ë‹ˆë‹¤.
- ëŒ€ë¶€ë¶„ì˜ ì–¸ì–´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ central repository ì— ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.
- Rì—ì„œëŠ” CRANì´ë¼ê³  í•©ë‹ˆë‹¤. íŒŒì´ì¬ë„ ë§ˆì°¬ê°€ì§€ë¡œ CPANì´ë¼ê³  í•˜ë©´ python repositoryì— 
- central repository ì—ì„œ ì œê³µí•˜ì§€ ì•Šì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì €ì¥ì†Œë¥¼ ì§ì ‘ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.
- module.gradleì— í•˜ë‚˜ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì§€ì •
- pythonì´ë‘ Rì´ ì´ë¶€ë¶„ì´ ë‹¤ë¦…ë‹ˆë‹¤. settings.gradleì€ ì‚¬ì‹¤ jsoní˜•íƒœì…ë‹ˆë‹¤. xml json yaml ë“±ì´ ìˆì§€ë§Œ ì•„ì§ì€ xmlê³¼ jsonì„ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤.



## 2.setting.gradleì„¤ì •

maven repository ì¶”ê°€

```json
maven{url 'https://jitpack.io'}
```



Android ì„¤ì •ì„ ë°”ê¿”ì£¼ê³  ë‚˜ë©´ sinkë¥¼ ëˆŒëŸ¬ì¤˜ì•¼ í•©ë‹ˆë‹¤.



## 3.build.gradleì— drawing ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€

projectê°€ moduleë³´ë‹¤ í° ê°œë…ìœ¼ë¡œ moduleì€ projectì•ˆì˜ ê°ê°ì˜ ë¶€í’ˆë“¤ì…ë‹ˆë‹¤.

moduleì˜ build.gradleì„ ë³´ë©´ dependencies

- test~ : appì„ ê°œë°œí•  ë• ì‚¬ìš©í•˜ì§€ë§Œ ë°°í¬í•  ë•Œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ

- implementation : ì‹œì‘ë  ë•Œ ì‚¬ìš©

```json
dependencies {

    implementation 'androidx.appcompat:appcompat:1.3.1'
    implementation 'com.google.android.material:material:1.4.0'
    implementation 'androidx.constraintlayout:constraintlayout:2.1.0'
    testImplementation 'junit:junit:4.+'
    androidTestImplementation 'androidx.test.ext:junit:1.1.3'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.4.0'

```



drawing ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ ì¶”ê°€

```json
dependencies {
	implementation 'com.github.divyanshub024:AndroidDraw:v0.1'
}
```



### 4.assets ì¶”ê°€







# í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ëª¨ë¸ ìƒì„±(Functional APIë¥¼ ì´ìš©)

ë” ë‹¤ì–‘í•œ ë°©ë²•ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



```python
def funtionalAPI(self):
    inputs = tf.keras.Input(shape=(28, 28))
    x = tf.keras.layers.Flatten()(inputs)
    x = tf.keras.layers.Flatten(18, activation='relu')(x)
    outputs = tf.keras.layers.Dense(10, activation='softmax')(x)
    mlp_model = tf.kersa.Model(inputs=inputs, outputs= outputs)
    mlp_model.compile(optimizer='adam',
    loss='categorical_crossentropy',
    metrics=['accuracy'])

    y_train = tf.keras.utils.to_categorical(self.y_train)
    y_test = tf.keras.utils.to_categorical(self.y_test)

    # ëª¨ë¸ í•™ìŠµ
    mlp_model.fit(self.X_train, y_train, epochs=5)

    # ëª¨ë¸ í‰ê°€
    # 1 : ê³¼ì •í‘œì‹œ, 2 : ì†ì‹¤í‘œì‹œ
    mlp_model.evaluate(self.X_test, y_test, verbose=2)
```



# ìƒì†ì„ ì´ìš©í•œ ëª¨ë¸ ìƒì„±

```
# ìƒì†ì„ ì´ìš©í•˜ì—¬ ì¬ì‚¬ìš©ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
# ëª¨ë¸ ìì²´ë¥¼ ë°°í¬í•  ë•Œë„ ì´ ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
class MLP_Model(tf.keras.Model):
    def __init__(self):
        super(MLP_Model, self).__init__()
        self.flatten = tf.keras.layers.Flatten()
        self.dense = tf.keras.layers.Dense(128, activation='relu')
        self.softmax = tf.keras.layers.Dense(10, activation='softmax')

    def call(self, inputs):
        x = self.flatten(inputs)
        x = self.dense(x)
        return self.softmax(x)
	
if __name__ == '__main__':
    dl = DeepLearningModelCreate()
    dl.createDataSet()
    dl.dataNormalization()
    
	mlp_model = MLP_Model()
    mlp_model.compile(optimizer='adam',
                      loss='categorical_crossentropy',
                      metrics=['accuracy'])

    # ëª¨ë¸ í•™ìŠµ
    mlp_model.fit(dl.X_train, dl.y_train, epochs=5)

    # ëª¨ë¸ í‰ê°€
    # 1 : ê³¼ì •í‘œì‹œ, 2 : ì†ì‹¤í‘œì‹œ
    mlp_model.evaluate(dl.X_test, dl.y_test, verbose=2)
```



# í•©ì„±ê³± ì‹ ê²½ë§ ì´ìš© - ì´ë¯¸ì§€ ì²˜ë¦¬ì— ì í•©



ì •ê·œí™”ë¥¼ í•˜ì§€ ì•Šì•˜ì„ ë•Œë³´ë‹¤ ì •ê·œí™”ë¥¼ í–‡ì„ ëŒ€ ì •í™•ë„ê°€ ë” ë†’ê²Œ ë‚˜ì˜´

ì›ë³¸ ë°ì´í„°ì˜ ê°’ì˜ ë²”ìœ„ëŠ” 0~255ì¸ë° 0.0ì—ì„œ 1.0ì‚¬ì´ë¡œ ì •ê·œí™”ë¡œ í•¨

ì…ë ¥ë°ì´í„°ë¥¼ ìˆ˜ì •



ì†ŒìŠ¤ì½”ë“œ : [CNNModeling.py]()

```python
def createModel(self):
    X_train_4d = self.X_train.reshape(-1, 28, 28, 1)
    X_test_4d = self.X_test.reshape(-1, 28, 28, 1)

    # ì…ë ¥ë°ì´í„°ë¥¼ ìˆ˜ì •
    cnn_model = tf.keras.models.Sequential([
        tf.keras.layers.Conv2D(32, (3, 3), activation='relu',
                               input_shape=(28, 28, 1)),
        tf.keras.layers.MaxPooling2D((2, 2)),

        tf.keras.layers.Conv2D(64, (3, 3), activation='relu'),
        tf.keras.layers.MaxPooling2D((2, 2)),

        tf.keras.layers.Conv2D(64, (3, 3), activation='relu'),
        tf.keras.layers.Flatten(),
        tf.keras.layers.Dense(64, activation='relu'),
        tf.keras.layers.Dense(10, activation='softmax')
    ])


    # ëª¨ë¸ ì»´íŒŒì¼
    cnn_model.compile(optimizer='adam',
                      loss='sparse_categorical_crossentropy',
                      metrics=['accuracy'])
    # ëª¨ë¸ í•™ìŠµ
    cnn_model.fit(X_train_4d, self.y_train, epochs=5)

    # ëª¨ë¸ í‰ê°€
    cnn_model.evaluate(X_test_4d, self.y_test, verbose=2)

```

```
Epoch 1/5
1875/1875 [==============================] - 16s 8ms/step - loss: 0.1471 - accuracy: 0.9539
Epoch 2/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0458 - accuracy: 0.9861
Epoch 3/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0333 - accuracy: 0.9895
Epoch 4/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0252 - accuracy: 0.9919
Epoch 5/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0203 - accuracy: 0.9933
313/313 - 1s - loss: 0.0296 - accuracy: 0.9901
```



# ì¼€ë¼ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë¸ ì´ìš©

- ì¼€ë¼ìŠ¤ API ëª¨ë“ˆì—ì„œ ëª‡ ê°€ì§€ ëª¨ë¸ì„ ì œê³µ

- ResNet ì€ ì”ì°¨ í•™ìŠµì„ ì´ìš©í•´ì„œ ì„±ëŠ¥ í–¥ìƒì„ ì´ë£¬ ëª¨ë¸ë¡œ ì”ì°¨ ë¸”ë¡ì„ ì—¬ëŸ¬ ì¸µ ìŒ“ì€ êµ¬ì¡°

- ResNetì€ 32 x 32 ì‚¬ì´ì¦ˆì˜ ì´ë¯¸ì§€ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ì„œ ë§Œë“¤ì–´ì§„ ëª¨ë¸

ì´ ëª¨ë¸ì„ ì“°ê³  ì‹¶ìœ¼ë©´ ë³¸ì¸ì˜ ì…ë ¥ë°ì´í„°ë¥¼ 32 x 32ë¡œ reshapeí•´ì•¼ í•©ë‹ˆë‹¤.

ì¸µì˜ ê¹Šì´ê°€ ë” ê¹Šê¸° ë•Œë¬¸ì— í›ˆë ¨ì‹œê°„ì´ ë” ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤.

[ì†ŒìŠ¤ì½”ë“œ ResNetModeling.py]()

```python
def createModel(self):
    X_train_4d = self.X_train.reshape(-1, 28, 28, 1)
    X_test_4d = self.X_test.reshape(-1, 28, 28, 1)

    # ResNetì— ë§ê²Œ ì…ë ¥ë°ì´í„° ìˆ˜ì •
    resized_X_train = tf.image.resize(X_train_4d, [32, 32])
    resized_X_test = tf.image.resize(X_test_4d, [32, 32])

    # ëª¨ë¸ ìƒì„±
    resnet_model = tf.keras.applications.ResNet50V2(
        input_shape=(32, 32, 1),
        classes = 10,
        weights=None
    )

    # ëª¨ë¸ ì»´íŒŒì¼
    resnet_model.compile(optimizer='adam',
    loss='sparse_categorical_crossentropy',
    metrics=['accuracy'])
    # ëª¨ë¸ í•™ìŠµ
    resnet_model.fit(resized_X_train, self.y_train, epochs=5)

    # ëª¨ë¸ í‰ê°€
    resnet_model.evaluate(resized_X_test, self.y_test, verbose=2)
```

```
11493376/11490434 [==============================] - 0s 0us/step
11501568/11490434 [==============================] - 0s 0us/step
Epoch 1/5
1875/1875 [==============================] - 370s 195ms/step - loss: 0.2136 - accuracy: 0.9419
Epoch 2/5
1875/1875 [==============================] - 368s 196ms/step - loss: 0.1022 - accuracy: 0.9719
Epoch 3/5
1875/1875 [==============================] - 371s 198ms/step - loss: 0.1156 - accuracy: 0.9729
Epoch 4/5
1875/1875 [==============================] - 372s 198ms/step - loss: 0.0864 - accuracy: 0.9777
Epoch 5/5
1875/1875 [==============================] - 377s 201ms/step - loss: 0.0623 - accuracy: 0.9838
313/313 - 14s - loss: 0.0372 - accuracy: 0.9903

```



# ì „ì´í•™ìŠµ



# ëª¨ë¸ ë³€í™˜

- 
- 