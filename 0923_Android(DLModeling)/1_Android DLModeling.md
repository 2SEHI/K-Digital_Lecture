# tfliteëª¨ë¸ì„ ìƒì„±í•˜ì—¬ Androidì—ì„œ ëª¨ë¸ ì‚¬ìš©í•˜ê¸°



# Android DLí•™ìŠµë°©ë²•

- [Client ìª½ì—ì„œ ê¸°ê³„í•™ìŠµ](#1clientìª½ì—ì„œ-ê¸°ê³„í•™ìŠµ)
- [Server ìª½ì—ì„œ ê¸°ê³„í•™ìŠµ](#2serverìª½ì—ì„œ-ê¸°ê³„í•™ìŠµ)



## 1.Clientìª½ì—ì„œ ê¸°ê³„í•™ìŠµ

ì•ˆë“œë¡œì´ë“œ(iOS)ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ê¸°ê³„ í•™ìŠµì„ ì´ìš©

- ê¸°ê³„í•™ìŠµ ëª¨ë¸ì„ ì„œë²„ì— ë‘ê³  ìŠ¤ë§ˆíŠ¸ í°ì˜ ì•±ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ëŠ” ì…ì¶œë ¥ì˜ ì—­í• ë§Œ ìˆ˜í–‰

- ìŠ¤ë§ˆíŠ¸ í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ë°ì´í„° ì…ì¶œë ¥í•˜ëŠ” ë°©ë²•ë§Œ ë°°ìš°ë©´ ë©ë‹ˆë‹¤.



### ì¥/ë‹¨ì 

- ë‹¨ì 
  - í•­ìƒ ì˜¨ë¼ì¸ ìƒíƒœì—¬ì•¼ ì‚¬ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤.

- ì¥ì 
  - ëª¨ë¸ì„ í•œë²ˆë§Œ ìƒì„±í•˜ë©´ ë©ë‹ˆë‹¤



## 2.Serverìª½ì—ì„œ ê¸°ê³„í•™ìŠµ

ìŠ¤ë§ˆíŠ¸í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì— ê¸°ê³„ í•™ìŠµ ëª¨ë¸ì„ ì €ì¥í•´ì„œ ìŠ¤ë§ˆíŠ¸ í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ì—¬ ì¶œë ¥í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•

- ëª¨ë¸ ìì²´ëŠ” ì¼ë°˜ì ìœ¼ë¡œ PCì—ì„œ ë§Œë“¤ê³  ì´ë¥¼ ìŠ¤ë§ˆíŠ¸ í°ì´ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë³€í™˜í•´ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
- ì¼€ë¼ìŠ¤ì˜ ê²½ìš°ëŠ” ì•ˆë“œë¡œì´ë“œì—ì„œ ë™ì‘í•˜ëŠ” TensorFlow liteê°€ ìˆìŠµë‹ˆë‹¤
- ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ ë™ì‘í•˜ëŠ” TensorFlow.jsì˜ ëª¨ë¸ë¡œ ë³€í™˜í•´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤



### ì¥/ë‹¨ì 

- ë‹¨ì  
  - ëª¨ë¸ì„ ìˆ˜ì •í•˜ë©´ ë‹¤ì‹œ ë°°í¬í•´ì•¼ í•©ë‹ˆë‹¤. PCì—ì„œ ìˆ˜í–‰í–ˆë˜ ì „ì²˜ë¦¬ë¥¼ ìŠ¤ë§ˆíŠ¸í°ì—ì„œ ë‹¤ì‹œ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ”ë° ì´ ë•Œ ì–¸ì–´ë‚˜ í”„ë ˆì„ì›Œí¬ê°€ ì§€ì›ì´ ì•ˆë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  - OpenCVê°™ì€ ê²½ìš°ëŠ” ì–¸ì–´ë³„ë¡œ ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¡´ì¬í•˜ëŠ”ë° ëª¨ë“  ë””ë°”ì´ìŠ¤ì—ì„œ ì§€ì›í•˜ëŠ” ì–¸ì–´ëŠ” C++ì…ë‹ˆë‹¤.
  - ì–´ë–¤ ì–¸ì–´ë¡œ êµ¬í˜„í•˜ê²Œ ë ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì‚¬ì‹¤ ì–´ë–¤ ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ëŠëƒ ë³´ë‹¤ ì•Œê³ ë¦¬ì¦˜ì´ ë” ì¤‘ìš”í•©ë‹ˆë‹¤.
- ì¥ì 
  - ì˜¨ë¼ì¸ ìƒíƒœê°€ ì•„ë‹ˆì—¬ë„ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.



# í…ì„œí”Œë¡œ ë¼ì´íŠ¸ ëª¨ë¸ ê°œë°œ WorkFlow

`1.ëª¨ë¸ ìƒì„± ğŸ‘‰ 2.ëª¨ë¸ ë³€í™˜ ğŸ‘‰ 3.ê¸°ê¸° ë°°í¬ ğŸ‘‰ 4.ëª¨ë¸ ìµœì í™”`

** `4.ëª¨ë¸ ìµœì í™”`ë¥¼ í•œ í›„ ë‹¤ì‹œ ëª¨ë¸ ë³€í™˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²½ìš°ë„ ìˆìŠµë‹ˆë‹¤.



# ëª¨ë¸ ì„ íƒ ë°©ë²•

- í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì‘ì„±í•  ë•Œ ë³¸ì¸ì´ ì‚¬ìš©í•œ ëª¨ë¸ì´ ì‚¬ì „ í•™ìŠµì¸ì§€ ì „ì´ í•™ìŠµì„ ì´ìš©í•˜ëŠ” ê²ƒì„ êµ¬ë³„í•  ì¤„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤

ì´ë¯¸ í›ˆë ¨ëœ ëª¨ë¸ë¡œ í•™ìŠµ ì ˆì°¨ì—†ì´ ë°”ë¡œ ì´ ëª¨ë¸ì„ ì´ìš©í•´ì„œ ì¶”ë¡ í•  ìˆ˜ ìˆìŒ

í…ì„œí”Œë¡œ ëª¨ë¸ë¡œ ì œê³µí•˜ê¸°ë„ í•©ë‹ˆë‹¤.

kerasëª¨ë“ˆì—ì„œ ì œê³µí•˜ê¸°ë„ í•˜ê³  í…ì„œ í”Œë¡œ í—ˆë¸Œì—ê²Œ ì œê³µí•˜ê¸°ë„ í•©ë‹ˆë‹¤.

tensorFlow liteëª¨ë¸ë¡œ ì œê³µí•˜ëŠ” ì¢…ë¥˜ëŠ” ì´ë¯¸ì§€ ë¶„ë¥˜, ê°ì²´ íƒì§€, ì´ë¯¸ì§€ ë¶„í• , ìì„¸ ì¶”ì •, ìŠ¤íƒ€ì¼ ë³€í™˜. í…ìŠ¤íŠ¸ ë³€í™˜, ì§ˆì˜ ì‘ë‹µ, ìŠ¤ë§ˆíŠ¸ ë‹µì¥(ì±—ë³¸) ë“±ì´ ìˆìŠµë‹ˆë‹¤. 

- ëª¨ë¸ì€ ì§ì ‘ ìƒì„±í•  ìˆ˜ ìˆê³  ì´ë¯¸ ê°œë°œëœ ëª¨ë¸ì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ëª¨ë¸ ì§ì ‘ ê°œë°œ : `ì„¤ê³„ ğŸ‘‰ í•™ìŠµ ğŸ‘‰ ë³€í™˜`
- ì‚¬ì „ í•™ìŠµ ëª¨ë¸ ì´ìš©
  - í…ì„œí”Œë¡œ ëª¨ë¸  :`í•™ìŠµ ğŸ‘‰ ë³€í™˜`ì˜ ê³¼ì •ì´ë‚˜ `ë³€í™˜`ë§Œìœ¼ë¡œ ì‚¬ìš©
  - í…ì„œí”Œë¡œ ë¼ì´íŠ¸ ëª¨ë¸ : ì•„ë¬´ëŸ° ì‘ì—…ë„ í•  í•„ìš”ê°€ ì—†ìŒ
- ì „ì´ í•™ìŠµ : `í•™ìŠµ ğŸ‘‰ ë³€í™˜`



# 1.ëª¨ë¸ ìƒì„±

## ğŸ“Œì§ì ‘ ëª¨ë¸ ìƒì„±

MNISTë°ì´í„° ì…‹ì„ ì´ìš©í•˜ì—¬ ì†ê¸€ì”¨ ë¶„ë¥˜ ëª¨ë¸ì„ ì§ì ‘ìƒì„±, ì‚¬ì „í•™ìŠµ, ì „ì´ í•™ìŠµë°©ë²•ìœ¼ë¡œ ìƒì„±í•´ë´…ë‹ˆë‹¤.



### 0) ê³µí†µ

#### - ë°ì´í„° ì¤€ë¹„

ë°ì´í„°ëŠ” í…ì„œí”Œë¡œ ë°ì´í„° ì…‹ì„ ì´ìš©í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ëŠ” 28* 28 í¬ê¸°ì˜ ì´ë¯¸ì§€ë¡œ 7ë§Œê°œì˜ ë°ì´í„°ë¡œ êµ¬ì„±ë˜ì–´ìˆìŠµë‹ˆë‹¤.

```python
## ë°ì´í„° ì¤€ë¹„
import tensorflow as tf
mnist = tf.keras.datasets.mnist
(X_train, y_train), (X_test, y_test) = mnist.load_data()
```



#### - ë°ì´í„° ì •ê·œí™”

- ë°ì´í„°ì˜ ë²”ìœ„ë¥¼ ì¼ì •í•˜ê²Œ ë§Œë“œëŠ” ê²ƒ

- ì •ê·œí™”ë¥¼ í•˜ì§€ ì•Šì•˜ì„ ë•Œë³´ë‹¤ ì •ê·œí™”ë¥¼ í–ˆì„ ë–„ ì •í™•ë„ê°€ ë†’ê²Œ ë‚˜ì˜µë‹ˆë‹¤.

- ì›ë³¸ ë°ì´í„°ì˜ ê°’ ë²”ìœ„ëŠ” 0~255ì¸ë° 0.0ì—ì„œ 1.0ì‚¬ì´ë¡œ ì •ê·œí™” í•©ë‹ˆë‹¤.

```python
# ë°ì´í„° ì •ê·œí™”
X_train, X_test = X_train/255.0, X_test/255.0
```



### 1) ë‹¤ì¤‘ í¼ì…‰íŠ¸ë¡ 

- ëª¨ë¸ì„ ì§ì ‘ ë§Œë“¤ ë•ŒëŠ” ì €ìˆ˜ì¤€ API(í…ì„œ í”Œë¡œ, Thearno, CNTK ë“±)ì´ë‚˜ ê³ ìˆ˜ì¤€API(Keras, Pytorch)ì¤‘ì—ì„œ í•˜ë‚˜ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

ì†ŒìŠ¤ì½”ë“œ : [DeeLearningModelCreate.py](./src/DeeLearningModelCreate.py)

#### ëª¨ë¸ ìƒì„±

```python
# ë”¥ëŸ¬ë‹, ë‹¤ì¤‘ í¼ì…‰íŠ¸ë¡ 
mlp_model = tf.keras.models.Sequential([
    tf.keras.layers.Flatten(input_shape = (28, 28)),
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dense(10, activation='softmax')
])
```



#### ëª¨ë¸ ì»´íŒŒì¼

```python
# ëª¨ë¸ ì»´íŒŒì¼
mlp_model.compile(optimizer='adam',
                loss='sparse_categorical_crossentropy',
                metrics=['accuracy'])

y_train = tf.keras.utils.to_categorical(self.y_train)
y_test = tf.keras.utils.to_categorical(self.y_test)
```

##### **ì†ì‹¤ í•¨ìˆ˜ loss

- íšŒê·€(ê°’)
  - MSEëŒ€ì‹ ì— MAEë‚˜ RMSE ë“±ì„ ì‚¬ìš©í•˜ê¸°ë„ í•©ë‹ˆë‹¤.

- ë¶„ë¥˜(í™•ë¥ )
  - ì´ì§„ ë¶„ë¥˜ì˜ ê²½ìš° : binary_crossentropy
  - ë‹¤ì¤‘ ë¶„ë¥˜ì˜ ê²½ìš° : 
    - sparse_categorical_crossentropy(ì›í•«ì¸ì½”ë”©ì´ ì ìš©ë˜ì§€ ì•Šì€ ê²½ìš°)
    - categorical_crossentropy(ì›í•«ì¸ì½”ë”©ì´ ì ìš©ë˜ëŠ” ê²½ìš°)



#### ëª¨ë¸ êµ¬ì¡° í™•ì¸

```python
print(mlp_model.summary())
```

```
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
flatten (Flatten)            (None, 784)               0         
_________________________________________________________________
dense (Dense)                (None, 128)               100480    
_________________________________________________________________
dense_1 (Dense)              (None, 10)                1290      
=================================================================
Total params: 101,770
Trainable params: 101,770
Non-trainable params: 0
_________________________________________________________________
None

Process finished with exit code 0

```



#### ëª¨ë¸ í•™ìŠµ

```python
mlp_model.fit(self.X_train, y_train, epochs=5)
```

```
Epoch 1/5
1875/1875 [==============================] - 4s 1ms/step - loss: 0.2587 - accuracy: 0.9257
Epoch 2/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.1138 - accuracy: 0.9667
Epoch 3/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0797 - accuracy: 0.9759
Epoch 4/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0589 - accuracy: 0.9821
Epoch 5/5
1875/1875 [==============================] - 2s 1ms/step - loss: 0.0452 - accuracy: 0.9861
```



#### ëª¨ë¸ í‰ê°€

`verbose` 1 : ê³¼ì •í‘œì‹œ, 2 : ì†ì‹¤í‘œì‹œ

- `verbose=1` ê³¼ì •í‘œì‹œì˜ ê²½ìš°

```python
mlp_model.evaluate(self.X_test, y_test, verbose=1)
```

313/313 [==============================] - 0s 801us/step - loss: 0.0802 - accuracy: 0.9759

- `verbose=2`: ì†ì‹¤í‘œì‹œì˜ ê²½ìš°

```python
mlp_model.evaluate(self.X_test, y_test, verbose=2)
```

313/313 - 0s - loss: 0.0855 - accuracy: 0.9741



### 2) í•¨ìˆ˜ë¥¼ ì´ìš©í•œ ëª¨ë¸ ìƒì„±(Functional APIë¥¼ ì´ìš©)

ë” ë‹¤ì–‘í•œ ë°©ë²•ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.



ì†ŒìŠ¤ì½”ë“œ : [FuntionalAPI.py](./src/FuntionalAPI.py)

```python
def funtionalAPI():
    # mlp_model = tf.keras.models.Sequential([
    #     tf.keras.layers.Flatten(input_shape=(28, 28)),
    #     tf.keras.layers.Dense(128, activation='relu'),
    #     tf.keras.layers.Dense(10, activation='softmax')
    # ])
    
    # ìœ„ì˜ ì£¼ì„ì²˜ë¦¬ëœ ë¶€ë¶„ì´ë‘ ê°™ì€ í˜•íƒœ
    inputs = tf.keras.Input(shape=(28, 28))
    x = tf.keras.layers.Flatten()(inputs)
    x = tf.keras.layers.Dense(128, activation='relu')(x)
    x = tf.keras.layers.Dense(10, activation='softmax')(x)
    outputs = tf.keras.layers.Dense(10, activation='softmax')(x)

    X_train, X_test, y_train, y_test = createDataSet()
    y_train = tf.keras.utils.to_categorical(y_train)
    y_test = tf.keras.utils.to_categorical(y_test)

    mlp_model = tf.keras.Model(inputs=inputs, outputs= outputs)
    # ëª¨ë¸ ì»´íŒŒì¼
    mlp_model.compile(optimizer='adam',
                      loss='categorical_crossentropy',
                      metrics=['accuracy'])

    # ëª¨ë¸ í•™ìŠµ
    mlp_model.fit(X_train, y_train, epochs=5)

    # ëª¨ë¸ í‰ê°€
    # 1 : ê³¼ì •í‘œì‹œ, 2 : ì†ì‹¤í‘œì‹œ
    mlp_model.evaluate(X_test, y_test, verbose=2)
```



### 3) ìƒì† ì´ìš©

ìƒì†ì„ ì´ìš©í•˜ë©´ ì¬ì‚¬ìš©ì„±ì´ ë†’ì•„ì„œ ëª¨ë¸ ìì²´ë¥¼ ë°°í¬í•  ë•Œë„ ì´ ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.



ì†ŒìŠ¤ì½”ë“œ: [MLP_Model.py](./src/MLP_Model.py)

```python
# ìƒì†ì„ ì´ìš©í•˜ì—¬ ì¬ì‚¬ìš©ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
# ëª¨ë¸ ìì²´ë¥¼ ë°°í¬í•  ë•Œë„ ì´ ë°©ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
class MLP_Model(tf.keras.Model):
    def __init__(self):
        super(MLP_Model, self).__init__()
        self.flatten = tf.keras.layers.Flatten()
        self.dense = tf.keras.layers.Dense(128, activation='relu')
        self.softmax = tf.keras.layers.Dense(10, activation='softmax')

    def call(self, inputs):
        x = self.flatten(inputs)
        x = self.dense(x)
        return self.softmax(x)
```



### 4) í•©ì„±ê³± ì‹ ê²½ë§ ì´ìš© - ì´ë¯¸ì§€ ì²˜ë¦¬ì— ì í•©



ì •ê·œí™”ë¥¼ í•˜ì§€ ì•Šì•˜ì„ ë•Œë³´ë‹¤ ì •ê·œí™”ë¥¼ í–‡ì„ ëŒ€ ì •í™•ë„ê°€ ë” ë†’ê²Œ ë‚˜ì˜´

ì›ë³¸ ë°ì´í„°ì˜ ê°’ì˜ ë²”ìœ„ëŠ” 0~255ì¸ë° 0.0ì—ì„œ 1.0ì‚¬ì´ë¡œ ì •ê·œí™”ë¡œ í•¨

ì…ë ¥ë°ì´í„°ë¥¼ ìˆ˜ì •



ì†ŒìŠ¤ì½”ë“œ : [CNNModeling.py](./src/CNNModeling.py)

```python
def createModel(self):
    X_train_4d = self.X_train.reshape(-1, 28, 28, 1)
    X_test_4d = self.X_test.reshape(-1, 28, 28, 1)

    # ì…ë ¥ë°ì´í„°ë¥¼ ìˆ˜ì •
    cnn_model = tf.keras.models.Sequential([
        tf.keras.layers.Conv2D(32, (3, 3), activation='relu',
                               input_shape=(28, 28, 1)),
        tf.keras.layers.MaxPooling2D((2, 2)),

        tf.keras.layers.Conv2D(64, (3, 3), activation='relu'),
        tf.keras.layers.MaxPooling2D((2, 2)),

        tf.keras.layers.Conv2D(64, (3, 3), activation='relu'),
        tf.keras.layers.Flatten(),
        tf.keras.layers.Dense(64, activation='relu'),
        tf.keras.layers.Dense(10, activation='softmax')
    ])


    # ëª¨ë¸ ì»´íŒŒì¼
    cnn_model.compile(optimizer='adam',
                      loss='sparse_categorical_crossentropy',
                      metrics=['accuracy'])
    # ëª¨ë¸ í•™ìŠµ
    cnn_model.fit(X_train_4d, self.y_train, epochs=5)

    # ëª¨ë¸ í‰ê°€
    cnn_model.evaluate(X_test_4d, self.y_test, verbose=2)

```

```
Epoch 1/5
1875/1875 [==============================] - 16s 8ms/step - loss: 0.1471 - accuracy: 0.9539
Epoch 2/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0458 - accuracy: 0.9861
Epoch 3/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0333 - accuracy: 0.9895
Epoch 4/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0252 - accuracy: 0.9919
Epoch 5/5
1875/1875 [==============================] - 15s 8ms/step - loss: 0.0203 - accuracy: 0.9933
313/313 - 1s - loss: 0.0296 - accuracy: 0.9901
```



## ğŸ“Œì‚¬ì „í•™ìŠµ ëª¨ë¸



### 1) ì‚¬ì „í•™ìŠµëª¨ë¸ê³¼ ì „ì´ í•™ìŠµ

**ì‚¬ì „ í•™ìŠµ ëª¨ë¸ì„ ê·¸ëƒ¥ ì‚¬ìš©í•˜ëŠ” ê²ƒ**ê³¼ **ì‚¬ì „í•™ìŠµ ëª¨ë¸ì„ ì´ìš©í•´ ì „ì´ í•™ìŠµí•˜ëŠ” ê²ƒ**ì„ êµ¬ë³„í•  ì¤„ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.

- ì‚¬ì „í•™ìŠµ ëª¨ë¸
  - ì´ë¯¸ í›ˆë ¨ëœ ëª¨ë¸ì„ ì˜ë¯¸í•˜ë©°, ì‚¬ì „í•™ìŠµ ëª¨ë¸ì„ ìˆ˜ì •í•˜ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ë©´ ì „ì´ í•™ìŠµì´ ì•„ë‹™ë‹ˆë‹¤.
  - TensorFlow Lite ëª¨ë¸ë¡œ ì œê³µí•˜ëŠ” ì¢…ë¥˜ëŠ” ì´ë¯¸ì§€ ë¶„ë¥˜, ê°ì²´ íƒì§€, ì´ë¯¸ì§€ ë¶„í• , ìì„¸ ì¶”ì •, ìŠ¤íƒ€ì¼ ë³€í™˜. í…ìŠ¤íŠ¸ ë³€í™˜, ì§ˆì˜ ì‘ë‹µ, ìŠ¤ë§ˆíŠ¸ ë‹µì¥(ì±—ë³¸) ë“±ì´ ìˆìŠµë‹ˆë‹¤.

- ì „ì´ í•™ìŠµ
  - ì‚¬ì „í•™ìŠµ ëª¨ë¸ì„ ìì‹ ì˜ ë°ì´í„°ì…‹ì— ë§ê²Œ ìƒˆë¡œ í›ˆë ¨ ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤. 



### 2) ì‚¬ì „í•™ìŠµëª¨ë¸ Hub

- TensorFlow Hub: [https://tfhub.dev](https://tfhub.dev/)

- TensorFlow Model Garden Github : [https://github.com/tensorflow/models/tree/master/research](https://github.com/tensorflow/models/tree/master/research)

- Papers with Code :[https://paperswithcode.sofa](https://paperswithcode.sofa/)



### 3) ë°ì´í„° ì…‹ ì €ì¥ì†Œ

- TensorFlow DataSet : [https://www.tensorflow.org/datasets](https://www.tensorflow.org/datasets)

- Google Research DataSet : [https://datasetsearch.research.google.com/](https://datasetsearch.research.google.com/)
- Google Clout DataSet : [https://cloud.google.com/solutions/datasets](https://cloud.google.com/solutions/datasets)

- Kaggle DataSet : [https://www.kaggle.com/datasets?fileType=csv](https://www.kaggle.com/datasets?fileType=csv)



### 4) ResNet ëª¨ë¸ ì´ìš©

- Keras API ëª¨ë“ˆì—ì„œ ëª‡ ê°€ì§€ ëª¨ë¸ì„ ì œê³µí•˜ëŠ”ë° ê·¸ ì¤‘ì— ResNet ì€ ì”ì°¨ í•™ìŠµì„ ì´ìš©í•´ì„œ ì„±ëŠ¥ í–¥ìƒì„ ì´ë£¬ ëª¨ë¸ë¡œ ì”ì°¨ ë¸”ë¡ì„ ì—¬ëŸ¬ ì¸µ ìŒ“ì€ êµ¬ì¡°ì…ë‹ˆë‹¤.

- ResNetì€ 32 x 32 ì‚¬ì´ì¦ˆì˜ ì´ë¯¸ì§€ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ì„œ ë§Œë“¤ì–´ì§„ ëª¨ë¸ì´ë¯€ë¡œ ì…ë ¥ë°ì´í„°ë¥¼ 32 x 32ë¡œ reshapeí•´ì•¼ í•©ë‹ˆë‹¤.

- ì¸µì˜ ê¹Šì´ê°€ ë” ê¹Šê¸° ë•Œë¬¸ì— í›ˆë ¨ì‹œê°„ì´ ë” ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤.



ì†ŒìŠ¤ì½”ë“œ : [ResNetModeling.py](./src/ResNetModeling.py)

```python
def createModel(self):
    X_train_4d = self.X_train.reshape(-1, 28, 28, 1)
    X_test_4d = self.X_test.reshape(-1, 28, 28, 1)

    # ResNetì— ë§ê²Œ ì…ë ¥ë°ì´í„° ìˆ˜ì •
    resized_X_train = tf.image.resize(X_train_4d, [32, 32])
    resized_X_test = tf.image.resize(X_test_4d, [32, 32])

    # ëª¨ë¸ ìƒì„±
    resnet_model = tf.keras.applications.ResNet50V2(
        input_shape=(32, 32, 1),
        classes = 10,
        weights=None
    )

    # ëª¨ë¸ ì»´íŒŒì¼
    resnet_model.compile(optimizer='adam',
    loss='sparse_categorical_crossentropy',
    metrics=['accuracy'])
    # ëª¨ë¸ í•™ìŠµ
    resnet_model.fit(resized_X_train, self.y_train, epochs=5)

    # ëª¨ë¸ í‰ê°€
    resnet_model.evaluate(resized_X_test, self.y_test, verbose=2)
```

```
11493376/11490434 [==============================] - 0s 0us/step
11501568/11490434 [==============================] - 0s 0us/step
Epoch 1/5
1875/1875 [==============================] - 370s 195ms/step - loss: 0.2136 - accuracy: 0.9419
Epoch 2/5
1875/1875 [==============================] - 368s 196ms/step - loss: 0.1022 - accuracy: 0.9719
Epoch 3/5
1875/1875 [==============================] - 371s 198ms/step - loss: 0.1156 - accuracy: 0.9729
Epoch 4/5
1875/1875 [==============================] - 372s 198ms/step - loss: 0.0864 - accuracy: 0.9777
Epoch 5/5
1875/1875 [==============================] - 377s 201ms/step - loss: 0.0623 - accuracy: 0.9838
313/313 - 14s - loss: 0.0372 - accuracy: 0.9903

```



## ğŸ“ŒTensorFlow ì „ì´ëª¨ë¸

### 1) ëª¨ë¸ ê²€ìƒ‰

- TensorFlow Hub: [https://tfhub.dev](https://tfhub.dev/) ì—ì„œ "mobilenet_v2_100_224" ê²€ìƒ‰
  - 100_224 ëŠ” ë„ˆë¹„ì™€ ë†’ì´ë¼ëŠ” ëœ»
  - ëª¨ë¸ ì´ë¦„ ë’¤ì— feature_vectorê°€ ë¶™ëŠ” ê²½ìš°ëŠ” ì „ì´ í•™ìŠµì´ ê°€ëŠ¥í•˜ë„ë¡ ë§ˆì§€ë§‰ ë ˆì´ì–´ë¥¼ ì œê±°í•œ ëª¨ë¸
  - classificationì´ ë¶™ì€ ê²½ìš°ì—” ë°”ë¡œ ë¶„ë¥˜ê°€ ê°€ëŠ¥í•œ ì „ì²´ ëª¨ë¸ì…ë‹ˆë‹¤.
- copy urlê³¼ downloadê°€ ê°€ëŠ¥í•œë° urlì´ ì¡´ì¬í•˜ë©´ Copy URLì„ ì„ íƒí•´ì„œ URL ì„ ë³µì‚¬í•©ë‹ˆë‹¤.

- tf lite ëŠ” ì•ˆë“œë¡œì´ë“œì—ì„œ ë°”ë¡œ ê°€ì ¸ë‹¤ê°€ ì“¸ìˆ˜ìˆìŠµë‹ˆë‹¤. 



### 2) ëª¨ë¸ ìƒì„±

ë³´í†µ ëª¨ë¸ ì´ë¦„ì€ ì•„ë˜ì™€ ê°™ì´ ìƒì„±í•©ë‹ˆë‹¤.

```python
ëª¨ë¸ ì´ë¦„ = tf.keras.Sequential([
	tensorflow_hub.KerasLayer(url, input_shape=(ì…ë ¥ êµ¬ì¡°), trainable=False),
	tf.keras.layers.Dense(ì¶œë ¥ì˜ ê°œìˆ˜)
])	
```



# 2.ëª¨ë¸ ë³€í™˜

í…ì„œí”Œë¡œ í—ˆë¸Œì—ì„œ ê°€ì ¸ì˜¨ ì „ì´ í•™ìŠµ ëª¨ë¸ì„ ìƒì„±í•´ë³´ê² ìŠµë‹ˆë‹¤.

- tensorflow liteëª¨ë¸(tflite í™•ì¥ìê°€ ì¼ë°˜ì )ë¡œ ë³€í™˜

- `tensorflow.lite.TFLiteCoverter.from_keras_model(ëª¨ë¸ì´ë¦„) `ì„ í˜¸ì¶œí•´ì„œ ë³€í™˜ê¸°ë¥¼ ë§Œë“¤ê³  convert í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ëª¨ë¸ì´ ë³€í™˜ì´ ë©ë‹ˆë‹¤.
- ë³€í™˜ëœ ëª¨ë¸ì„ íŒŒì¼ì— ê¸°ë¡í•˜ë©´ ë©ë‹ˆë‹¤.
- í™•ì¥ìëŠ” íŠ¹ë³„í•œ ê²½ìš°ê°€ ì•„ë‹ˆë©´ `tflite`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.



### 4) ì´ì „ì— ìƒì„±í•œ ëª¨ë¸ì„ TensorFlow Liteëª¨ë¸ë¡œ ë³€í™˜

[ResNet.py](#4-resnet-ëª¨ë¸-ì´ìš©) ì—ì„œ í›ˆë ¨ì‹œí‚¨ ëª¨ë¸ì„ ë³€í™˜í•˜ì˜€ìŠµë‹ˆë‹¤.

```python
# TensorFlowLite ëª¨ë¸ë¡œ ë³€í™˜
def convertTensorFlowLite(self, model):
    converter = tf.lite.TFLiteConverter.from_keras_model(model)
    tflite_model = converter.convert()

    with open('./keras_model.tflite', 'wb') as f:
    f.write(tflite_model)
```

```
INFO:tensorflow:Assets written to: /tmp/tmplife93gn/assets
/usr/local/lib/python3.7/dist-packages/keras/utils/generic_utils.py:497: CustomMaskWarning: Custom mask layers require a config and must override get_config. When loading, the custom mask layer must be passed to the custom_objects argument.
  category=CustomMaskWarning)
```



# 3.ê¸°ê¸° ë°°í¬

[ğŸ”¢ìˆ«ì ë¶„ë¥˜ Android Appë§Œë“¤ê¸°](../0924_Android(tflite)/1_ê¸°ê¸°ë°°í¬-ViewDrawingDigitClassifier.md)

[ê°¤ëŸ¬ë¦¬ì™€ ì¹´ë©”ë¼ë¡œ ì´¬ì˜í•œ ì´ë¯¸ì§€ ë¶„ë¥˜ ì•± ë§Œë“¤ê¸°](../0924_Android(tflite)/2_ê¸°ê¸°ë°°í¬-ImageClassfier.md)



# 4.ëª¨ë¸ ìµœì í™”

- ëª¨ë¸ì„ ë§Œë“¤ ë•Œë„ ìˆ˜í–‰í•˜ì§€ë§Œ ì•ˆë“œë¡œì´ë“œ ê¸°ê¸°ì—ì„œ ìµœì í™” ë˜ì—ˆëŠ”ì§€ ë‹¤ì‹œ í™•ì¸í•˜ê¸°ë„ í•©ë‹ˆë‹¤.
- ëŒ€ë¶€ë¶„ PCì—ì„œ ëª¨ë¸ ìƒì„±ì„ í•˜ëŠ”ë° ì•ˆë“œë¡œì´ë“œì—ì„œ ì„±ëŠ¥ì´ ë” ë–¨ì–´ì§ˆ ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
